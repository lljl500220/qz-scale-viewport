<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>🐱 Scale Viewport Demo</title>
</head>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    body, html {
        height: 100vh;
        overflow-x: hidden;
    }
    
    #wrapper {
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        position: relative;
        background-color: #f0f0f0;
    }
    
    #content {
        width: 750px;
        transform-origin: top center;
        overflow-y: auto;
        /* 默认值，会被JavaScript动态设置 */
        transform: scale(0.52);
        height: calc(100vh / 0.52);
        background-color: white;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    #value {
        width: 100%;
        height: 100px;
        position: sticky;
        top: 0;
        background-color: red;
        z-index: 100;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
    }
    
    #value2 {
        height: 2000px;
        width: 100%;
        background: linear-gradient(45deg, blue, lightblue);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
        flex-direction: column;
        gap: 20px;
    }
    
    #value3 {
        position: fixed;
        bottom: 0;
        width: 100%;
        height: 100px;
        background-color: green;
        z-index: 100;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    
    #value3:hover {
        background-color: darkgreen;
    }
    
    /* 实时指标显示 */
    .metrics {
        position: fixed;
        top: 10px;
        right: 10px;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 10px;
        border-radius: 5px;
        font-size: 12px;
        font-family: monospace;
        z-index: 1000;
    }
</style>
<body>
    <div id="wrapper">
        <div id="content">
            <div id="value">🐱 顶部固定区域 (Sticky Header)</div>
            <div id="value2">
                <div>可滚动内容区域 (Scrollable Content)</div>
                <div style="margin-top: 200px;">📱 测试滚动效果</div>
                <div style="margin-top: 300px;">🎯 PC端390px，移动端100vw</div>
                <div style="margin-top: 400px;">✨ 完美缩放适配</div>
                <div style="margin-top: 500px;">🚀 即将到底了...</div>
            </div>
            <div id="value3" onclick="toggleScroll()">底部固定区域 - 点击测试弹窗</div>
        </div>
    </div>
    
    
    <!-- 使用原始的内联JavaScript代码 -->
    <script>
        // 🐱 小喵的智能缩放系统 ✨ (原始内联版本)

        function setContentScale() {
            const content = document.getElementById('content');
            const wrapper = document.getElementById('wrapper');
            
            if (!content || !wrapper) {
                console.error('🐱 找不到content或wrapper元素！');
                return;
            }
            
            const screenWidth = window.innerWidth;
            let scale;
            
            // 判断是否为移动端（768px以下）
            if (screenWidth <= 768) {
                // 移动端：按屏幕宽度缩放，让750px容器铺满屏幕
                scale = screenWidth / 750;
                
                // 调整transform-origin为top left，避免居中导致的位置问题
                content.style.transformOrigin = 'top left';
                content.style.position = 'absolute';
                content.style.left = '0';
                content.style.top = '0';
                
                // wrapper不需要flex居中
                wrapper.style.display = 'block';
                wrapper.style.justifyContent = 'flex-start';
                
            } else {
                // PC端：固定缩放到390px，保持居中
                scale = 390 / 750; // 0.52
                
                content.style.transformOrigin = 'top center';
                content.style.position = 'static';
                content.style.left = 'auto';
                content.style.top = 'auto';
                
                // wrapper使用flex居中
                wrapper.style.display = 'flex';
                wrapper.style.justifyContent = 'center';
            }
            
            // 设置缩放和高度 - 这是关键！
            content.style.transform = `scale(${scale})`;
            content.style.height = `${100 / scale}vh`;
            
            console.log(`🐱 屏幕宽度: ${screenWidth}px, 缩放比例: ${scale.toFixed(4)}, 容器视觉宽度: ${(750 * scale).toFixed(0)}px`);
            
            // 更新指标显示
            updateMetrics(scale, screenWidth <= 768);
        }

        // 更新指标显示
        function updateMetrics(scale, isMobile) {
            const metrics = document.getElementById('metrics');
            if (metrics) {
                metrics.innerHTML = `
                    屏幕: ${window.innerWidth}px<br>
                    类型: ${isMobile ? '📱移动端' : '💻PC端'}<br>
                    缩放: ${scale.toFixed(4)}<br>
                    宽度: ${(750 * scale).toFixed(0)}px<br>
                    设计: 750px<br>
                    版本: 内联JS
                `;
            }
        }

        // 页面加载时设置
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setContentScale);
        } else {
            setContentScale();
        }

        // 窗口大小改变时重新设置
        window.addEventListener('resize', setContentScale);

        // 测试弹窗功能
        let scrollDisabled = false;
        function toggleScroll() {
            const content = document.getElementById('content');
            if (scrollDisabled) {
                content.style.overflow = 'auto';
                document.getElementById('value3').textContent = '底部固定区域 - 点击测试弹窗';
                scrollDisabled = false;
                console.log('🐱 恢复滚动');
            } else {
                content.style.overflow = 'hidden';
                document.getElementById('value3').textContent = '滚动已禁用 - 再次点击恢复';
                scrollDisabled = true;
                console.log('🐱 禁用滚动');
            }
        }

        console.log('🐱 Scale Viewport Demo 加载完成！(使用原始内联JavaScript版本)');
    </script>
</body>
</html>